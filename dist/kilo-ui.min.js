var kilo=function(t){"use strict";function e(t){var e;"complete"===document.readyState?t():e=setInterval(function(){"complete"===document.readyState&&(t(),clearInterval(e))},10)}var n,r,i,o,s={},u={},c=void 0,a=t;return r={isDefined:function(t){return"undefined"!=typeof t},isBoolean:function(t){return"boolean"==typeof t},def:function(t,e){return"undefined"==typeof t?e:t},error:function(t){throw new Error(a+": "+t)},warn:function(t){r.log("Warning: "+t)},log:function(t){n.log&&console.log(a+": "+t)},argsToArray:function(t){return Array.prototype.slice.call(t)},getGID:function(t){return t=r.def(t,""),u[t]=r.def(u[t],0),t+ ++u[t]},rand:function(t,e){return e=e||0,(e>t||e>t)&&r.error("rand: invalid range."),Math.floor(Math.random()*(t-e+1))+e}},["Array","Object","Arguments","Function","String","Number","Date","RegExp","HTMLImageElement"].forEach(function(t){r["is"+t]=function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}),i={unresolved:{},modules:{},register:function(t,e,n,r){return this.unresolved[t]={deps:e,func:n,scope:r},this},unresolve:function(t){this.modules[t]&&delete this.modules[t]},setModule:function(t,e){return this.modules[t]=e,this},getDependency:function(t){var e=this.modules[t];return e?e:(e=this.unresolved[t])?(r.log("Resolving dependencies for '"+t+"'"),e=this.modules[t]=this.resolveAndApply(e.deps,e.func,e.scope),r.isObject(e)&&(e.getType=function(){return t}),e):(r.warn("Module '"+t+"' not found"),null)},resolve:function(t){var e,n,i,o=[];for(i=0;i<t.length;i++)n=t[i],e=this.getDependency(n),e?o.push(e):r.warn("Can't resolve "+n);return o},apply:function(t,e,r){return e.apply(r||n,t)},resolveAndApply:function(t,e,n){return this.apply(this.resolve(t),e,n)}},i.setModule("helper",r).setModule("Helper",r).setModule("Util",r).setModule("injector",i).setModule("Injector",i).setModule("appConfig",s),n=function(t,e,n,o){if(r.isArray(t))i.resolveAndApply(t,e,n);else if(r.isArray(e)&&r.isFunction(n))i.register(t,e,n,o);else if(r.isFunction(e))i.register(t,[],e,n);else if(t&&!r.isDefined(e))return i.getDependency(t);return null},n.unresolve=function(t){i.unresolve(t)},n.noConflict=function(){return window[t]=c,n},n.element=function(t,n,s){var u;return r.isFunction(n)?s=n:r.isArray(n)?u=n:r.error("element: second argument should be function or dependency array."),e(function(){var e,n,r,c;if(!o){if(n=document.getElementsByTagName("body"),!n||!n[0])return;o=n[0].querySelectorAll("*")}for(e=0,r=o.length;r>e;e++)c=o[e],(c.hasAttribute("data-"+t)||c.hasAttribute(t))&&(u?s.apply(c,i.resolve(u)):s.call(c))}),this},n.onDocumentReady=n.ready=e,n.log=!0,window[t]&&(r.warn("a preexisting value at namespace '"+t+"' has been overwritten."),c=window[t]),window[t]=n,n}("kilo");kilo("Canvas",[],function(){"use strict";return{clearContext:function(t,e,n){t.clearRect(0,0,e,n)},drawBackground:function(t,e,n,r,i,o){t.fillStyle=o||"red",t.fillRect(r||0,i||0,e,n)},drawBorder:function(t,e,n,r,i,o){t.beginPath(),t.strokeStyle=o||"black",t.rect(r||0,i||0,e,n),t.stroke(),t.closePath()}}}),kilo("Extend",["Obj"],function(t){"use strict";return t.extend.bind(t)}),kilo("Factory",["Obj","Pool"],function(t){"use strict";return function(e){var n=t.mixin([e]);return n}}),kilo("Func",[],function(){"use strict";function t(t){var e=Array.prototype.slice.call(arguments,1);return function(){for(var n=e.slice(),r=0;r<arguments.length;r++)n.push(arguments[r]);return t.apply(this,n)}}function e(e,n){return t(n,e)}return{partial:t,wrap:e}}),kilo("HashArray",[],function(){"use strict";function t(){this.values=[],this.keyMap={}}function e(t,e){var n;for(n in t)t.hasOwnProperty(n)&&t[n]>e&&t[n]--}function n(t,e){var n;for(n in t)t.hasOwnProperty(n)&&t[n]>=e&&t[n]++}return t.prototype.set=function(t,e){return this.keyMap[t]?(this.values[this.keyMap[t]]=e,!0):(this.values.push(e),this.keyMap[t]=this.values.length-1,!1)},t.prototype.splice=function(t,e,r){var i=this.keyMap[t]+1;this.values.splice(i,0,r),n(this.keyMap,i),this.keyMap[e]=i},t.prototype.get=function(t){return this.values[this.keyMap[t]]},t.prototype.remove=function(t){var n=this.keyMap[t];this.values.splice(n,1),e(this.keyMap,n),delete this.keyMap[t]},t.prototype.removeAll=function(){var t,e=this.keyMap;this.values.length=0;for(t in e)delete e[t]},t.prototype.getIdByIndex=function(t){var e,n=this.keyMap;for(e in n)if(n[e]===t)return e;return""},t.prototype.getKeys=function(){var t,e=this.size(),n=[];for(t=0;e>t;t++)n.push(this.getIdByIndex(t));return n},t.prototype.getValues=function(){return this.values},t.prototype.size=function(){return this.values.length},t}),kilo("KeyStore",["HashArray","Util"],function(t,e){"use strict";function n(){this.lastId=0,this.store=new t}return n.prototype.get=function(t){return this.store.get(t)},n.prototype.set=function(t,n){var r;return e.isDefined(n)?r=t||this.lastId++:(r=this.lastId++,n=t),this.store.add(r,n),r},n.prototype.setGroup=function(t,n){var r,i;return e.isDefined(n)?(r=t,e.isDefined(r)?i=this.get(r):(r=this.lastId++,i=[],this.store.add(r,i))):(r=this.lastId++,n=t,i=[],this.store.add(r,i)),i?i.push(n):console.error("Jack2d: keyStore: id '"+r+"' not found."),r},n.prototype.clear=function(t){e.isDefined(t)?this.store.remove(t):this.store.removeAll()},n.prototype.getItems=function(){return this.store.items},n}),kilo("Mixin",["Obj"],function(t){"use strict";return t.mixin.bind(t)}),kilo("Obj",["Injector","Util","Func","Pool"],function(t,e,n,r){"use strict";function i(t,r,i,o){return t=t||{},t.__mixin===!1?void e.error("Can't mixin object because the object has disallowed it."):void Object.keys(t).forEach(function(s){r.hasOwnProperty(s)?i?(r[s]=n.wrap(r[s],t[s]),e.log("Mixin: wrapped '"+s+"'")):o?e.error("Failed to merge mixin. Method '"+s+"' caused a name collision."):(r[s]=t[s],e.log("Mixin: overwrote '"+s+"'")):r[s]=t[s]})}function o(t,n){var r={};return Object.keys(t).forEach(function(i){e.isFunction(t[i])&&(r[i]=s(t[i],t,n))}),r}function s(t,n,r){return function(){var i=e.argsToArray(arguments);return r?(i.unshift(t),r.apply(n,i)):t.apply(n,i)}}return{replaceMethod:function(t,e,n,r){Object.keys(t).forEach(function(i){t[i]===e&&(console.log(r),t[i]=n)})},augment:function(t,e){return o(t,e)},clone:function(t){return this.merge(t)},merge:function(t,e){var n;e=e||{};for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},create:function(t){return this.mixin(t)},print:function(t){var n,r="";for(n in t)t.hasOwnProperty(n)&&!e.isFunction(t[n])&&(r+=n+": "+t[n]+"<br>");return r},clear:function(t){var e;for(e in t)t.hasOwnProperty(e)&&delete t[e];return t},extend:function(){var t=arguments.length>1?e.argsToArray(arguments):arguments[0];return this.mixin(t,!0)},mixin:function(n,o,s){var u=r.getObject();return e.isArray(n)?n.forEach(function(n){e.isString(n)&&(n=t.getDependency(n)),i(n,u,o,s)}):(e.isString(n)&&(n=t.getDependency(n)),i(n,u,o,s)),u}}}),kilo("Pool",[],function(){"use strict";function t(){var t=i.pop();return t||(t={}),t}function e(t){var e;for(e in t)t.hasOwnProperty(e)&&delete t[e];return t}function n(t){i.push(e(t))}function r(){return i.length}var i=[];return{getObject:t,killObject:n,available:r}}),kilo("rect",[],function(){"use strict";function t(t,e,n){return!(t<n.left||t>n.right||e<n.top||e>n.bottom)}function e(t,e){return!(t.left<e.left||t.right>e.right||t.top<e.top||t.bottom>e.bottom)}function n(t,e){var n=!(t.left<e.left||t.right>e.right);return n?!1:t.left-e.left}function r(t,e){return!(t<e.left||t>e.right)}function i(t,e){var n=!(t.top<e.top||t.bottom>e.bottom);return n?!1:t.top-e.top}function o(t,e){return!(t<e.top||t>e.bottom)}function s(t,e){var n=!(e.left>=t.right||e.right<=t.left);return n?t.left-e.left:!1}function u(t,e){var n=!(e.top>=t.bottom||e.bottom<=t.top);return n?t.top-e.top:!1}return{setLeft:function(t){return this.left=t,this},setTop:function(t){return this.top=t,this},setRight:function(t){return this.right=t,this},setBottom:function(t){return this.bottom=t,this},containsPoint:t,containsRect:e,containsX:r,containsY:o,containsRectX:n,containsRectY:i,intersectsRectX:s,intersectsRectY:u}}),function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),r=Math.max(0,16-(n-t)),i=window.setTimeout(function(){e(n+r)},r);return t=n+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),kilo("SchedulerObject",["Util","Scheduler","Func"],function(t,e,n){"use strict";return{onFrame:function(n,r){var i=t.getGID(r);return this.chronoIds||(this.chronoIds=[]),this.hooks||(this.hooks={}),n=n.bind(this),r&&(this.hooks[r]=i),this.chronoIds.push(e.register(n,i)),this},getChronoId:function(t){return this.hooks?this.hooks[t]:null},hook:function(t,r){var i,o=this.getChronoId(t);o&&(i=e.getRegistered(o),i=n.wrap(i,r),e.register(i,o))},killOnFrame:function(t){return t?e.unRegister(t):this.chronoIds&&this.chronoIds.forEach(function(t){e.unRegister(t)}),this}}}),kilo("Scheduler",["HashArray","Util"],function(t,e){"use strict";function n(){return r(),l(),S}function r(){return w=60,b=0,k=0,j=0,F=0,I=0,A=new t,x=!1,O=new Date,S}function i(t,n){return e.isFunction(t)||e.error("Scheduler: only functions can be registered."),n||(n=e.getGID(n)),A.set(n,t),n}function o(t,e,n){return n||(n=F++),A.splice(t,n,e),n}function s(t){return A.remove(t),S}function u(t){return t?A.get(t):A.getValues()}function c(){R=window.requestAnimationFrame(f)}function a(){return A.size()}function l(){return x||(x=!0,M=window.setInterval(g,E),f()),S}function h(){return x=!1,window.clearInterval(M),window.cancelAnimationFrame(R),S}function f(){d(p()),m(),x&&c()}function d(t){var e,n,r,i;for(e=A.getValues(),n=e.length,i=0;n>i;i++)r=e[i],r&&r(t)}function p(){var t=+new Date,e=(t-O)/E;return O=t,e}function m(){k++}function g(){b=k.toString(),k=0,j++}function v(){return b}function y(){return j}var w,b,k,x,j,A,F,I,M,R,O,S,E=1e3;return n(),S={__mixin:!1,init:n,reset:r,start:l,stop:h,register:i,registerAfter:o,unRegister:s,getRegistered:u,registeredCount:a,getFps:v,getSeconds:y}}),jack2d("CanvasElement",["obj","Element","Requires"],function(t,e,n){"use strict";var r="rgba(184,184,184,0.5)";return t.mixin([e,{checkerBackground:n(["element"],function(t){var e,n,i,o=this.element,s=o.width,u=o.height,c=t||this.cellSize,a=s/c,l=u/c,h=o.getContext("2d");for(h.fillStyle=r,n=0;a>n;n++)for(e=n%2,i=0;l>i;i++)i%2===0&&h.fillRect(n*c,(i+e)*c,c,c);return this})}])}),jack2d("CanvasViewport",["helper","obj","rect","Canvas","Requires"],function(t,e,n,r,i){"use strict";function o(t,e,n){var r=t.getContext("2d");e.visible&&e.layer.draw(r,n)}return e.mixin(["Viewport","CanvasElement","ViewportFocus",{elPromise:function(t,e){return this.onFrame(this.updateViewport,this.getType()),t.call(this,e)},el:function(t,e){return this.elPromise(e),this},updateViewport:function(){this.checkFocusRegion(),this.draw()},clear:function(t,e){var n,i=this.element;return i&&(n=this.viewDimensions,r.clearContext(i.getContext("2d"),t||n.width,e||n.height)),this},drawBorder:function(t,e){var n=this.viewDimensions;return r.drawBorder(this.element.getContext("2d"),t||n.width,e||n.height),this},drawBackground:function(t,e,n){var i=this.viewDimensions;return r.drawBackground(this.element.getContext("2d"),t||i.width,e||i.height,n),this},drawLayer:i(["element","layers"],function(t){return o(this.element,this.layers[t],this.viewDimensions),this}),draw:i(["element","layers"],function(){var t,e,n=this.layers,i=this.element,s=i.getContext("2d"),u=this.viewDimensions,c=this.viewDelta,a=n.length;for(r.clearContext(s,c.width,c.height),e=0;a>e;e++)t=n[e],1===t.renderMode?o(i,t,c):o(i,t,u);return this.hasBorder&&r.drawBorder(s,u.width,u.height),this.drawFocusRegion&&r.drawBorder(s,this.focusRegion.right-this.focusRegion.left,this.focusRegion.bottom-this.focusRegion.top,this.focusRegion.left,this.focusRegion.top,"red"),this})}],!0)}),jack2d("debug",["helper","obj","chronoObject","Element"],function(t,e,n,r){"use strict";return e.mixin([n,r,{print:function(t,e){var n=this.contentList?this.contentList:this.contentList={};return n.hasOwnProperty(t)||(n[t]=document.createElement("div"),this.element.appendChild(n[t])),n[t].innerHTML!==e&&(n[t].innerHTML=e),this},printObject:function(e){var n,r;for(n in e)e.hasOwnProperty(n)&&(r=e[n],(t.isString(r)||t.isNumber(r)||t.isBoolean(r))&&this.print(n,n+": "+e[n]));return this},livePrint:function(t){return this.onFrame(t),this}}])}),jack2d("doc",["helper"],function(t){"use strict";function e(e){return new Promise(function(n,r){t.isString(e)?i().then(function(){var t=document.querySelectorAll(e)[0];t?n(t):r("Jack2d: element not found at '"+e+"'")}):n(e)})}function n(e){var n=r()?document.querySelectorAll(e):t.error("Jack2d: Can't select elements because document is not ready");return n.length>1?n:n[0]}function r(){return"complete"===document.readyState}function i(){return new Promise(function(t){var e;"complete"===document.readyState?t():e=setInterval(function(){"complete"===document.readyState&&(t(),clearInterval(e))},10)})}return{getElement:e,documentReady:r,onDocumentReady:i,el:n}}),jack2d("ElementFactory",["obj","Element"],function(t,e){"use strict";return function(n,r){var i=r?t.mixin(r.concat([e])):t.create(e);return n?i.el(n):i}}),jack2d("Element",["helper","obj","doc","input"],function(t,e,n,r){"use strict";return e.mixin(["chronoObject",{elPromise:function(e){var r=n.getElement(e);return t.isString(e)&&(this.elementSelector=e),r.then(function(t){return this.element=t,t}.bind(this),function(t){console.log(t)})},el:function(t){return this.elPromise(t),this},setStyle:function(t,e){return this.element.style[t]=e,this},updateElement:function(){var t;if(this.element)for(t in this)if(this.hasOwnProperty(t))switch(t){case"x":this.element.style.left=this.x+"px";break;case"y":this.element.style.top=this.y+"px";break;case"width":this.element.style.width=this.width+"px";break;case"height":this.element.style.height=this.height+"px"}},onInteract:function(e,n){var i,o,s;return i=this.element,o=e?e.bind(this):t.error("Jack2d: Element::onInteract requires at least one callback."),s=n?n.bind(this):null,this.onFrame(function(){var t=r.getInputs();t.interact&&t.interact.target===i?(o(t.interact),this.interacted=!0):s&&this.interacted&&(s(t.interact),this.interacted=!1)}),this}}])}),jack2d("hotspot",["obj","input"],function(t,e){"use strict";return t.mixin(["chronoObject","rect",{onInteract:function(t,n){var r=t.bind(this),i=n.bind(this);return this.onFrame(function(){var t=e.getInputs();t.interact&&this.containsPoint(t.interact.offsetX,t.interact.offsetY,this)?(r(t.interact),this.interacted=!0):this.interacted&&(i(t.interact),this.interacted=!1)}),this}}])}),jack2d("LiveElementFactory",["helper","obj","LiveElement"],function(t,e,n){"use strict";return function(r,i){var o;return i&&t.isArray(i)?(i.unshift(n),o=e.mixin(i)):o=e.create(n),r?o.el(r):o}}),jack2d("LiveElement",["helper","obj","chronoObject","Element"],function(t,e,n,r){"use strict";return e.extend([r,{el:function(e,n){return this.onFrame(this.updateElement,t.getGID("live-element")),e.call(this,n)}}])}),jack2d("Viewport",function(){"use strict";return function(){return{x:32,y:32,width:64,height:64}}});